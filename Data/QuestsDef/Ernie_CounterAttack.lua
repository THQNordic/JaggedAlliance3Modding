-- ========== GENERATED BY QuestsDef Editor (Ctrl-Alt-Q) DO NOT EDIT MANUALLY! ==========

PlaceObj('QuestsDef', {
	Author = "Boyan",
	Chapter = "Intro",
	Hidden = true,
	KillTCEsConditions = {
		PlaceObj('QuestKillTCEsOnCompleted', {}),
	},
	QuestGroup = "Ernie Island",
	TCEs = {
		PlaceObj('TriggeredConditionalEvent', {
			Conditions = {
				PlaceObj('QuestIsVariableBool', {
					QuestId = "PierreDefeated",
					Vars = set({
	PierreInactive = false,
}),
					__eval = function ()
						local quest = gv_Quests['PierreDefeated'] or QuestGetState('PierreDefeated')
						return not quest.PierreInactive
					end,
				}),
				PlaceObj('QuestIsVariableBool', {
					QuestId = "Ernie_CounterAttack",
					Vars = set( "Given" ),
					__eval = function ()
						local quest = gv_Quests['Ernie_CounterAttack'] or QuestGetState('Ernie_CounterAttack')
						return quest.Given
					end,
				}),
				PlaceObj('CityHasLoyalty', {
					Amount = 45,
					City = "ErnieVillage",
					Condition = ">=",
				}),
				PlaceObj('SatelliteGameplayRunning', {}),
				PlaceObj('QuestIsVariableBool', {
					Condition = "or",
					QuestId = "LegionFlag",
					Vars = set({
	Failed = true,
	Given = false,
}),
					__eval = function ()
						local quest = gv_Quests['LegionFlag'] or QuestGetState('LegionFlag')
						return quest.Failed or not quest.Given
					end,
				}),
			},
			Effects = {
				PlaceObj('PlayBanterEffect', {
					Banters = {
						"Radio_Pierre_CounterAttack",
					},
					FallbackToMerc = true,
					banterSequentialWaitFor = "BanterLineStart",
					searchInMarker = false,
				}),
				PlaceObj('TriggerGuardPostAttack', {
					custom_quest_id = "ErnieCounterAttack",
					effect_target_sector_ids = {
						"H2",
					},
					guardpost_sector_id = "H4",
					time = 57600,
				}),
			},
			Once = true,
			ParamId = "TCE_AttackStarted",
			QuestId = "Ernie_CounterAttack",
		}),
		PlaceObj('TriggeredConditionalEvent', {
			Conditions = {
				PlaceObj('QuestIsVariableBool', {
					QuestId = "02_LiberateErnie",
					Vars = set( "Completed" ),
					__eval = function ()
						local quest = gv_Quests['02_LiberateErnie'] or QuestGetState('02_LiberateErnie')
						return quest.Completed
					end,
				}),
				PlaceObj('SectorCheckOwner', {
					owner = "any enemy",
					sector_id = "H2",
				}),
				PlaceObj('QuestIsTCEState', {
					Prop = "TCE_AttackStarted",
					QuestId = "Ernie_CounterAttack",
					Value = "done",
				}),
			},
			Effects = {
				PlaceObj('QuestSetVariableBool', {
					Prop = "Ernie_retaken",
					QuestId = "TakeTheFortress",
				}),
			},
			Once = true,
			ParamId = "TCE_ErnieLost",
			QuestId = "Ernie_CounterAttack",
		}),
		PlaceObj('TriggeredConditionalEvent', {
			Conditions = {
				PlaceObj('SquadDefeated', {
					custom_squad_id = "ErnieCounterAttack",
				}),
			},
			Effects = {
				PlaceObj('QuestSetVariableBool', {
					Prop = "Completed",
					QuestId = "Ernie_CounterAttack",
				}),
			},
			Once = true,
			ParamId = "TCE_SquadDead",
			QuestId = "Ernie_CounterAttack",
		}),
	},
	Variables = {
		PlaceObj('QuestVarTCEState', {
			Name = "TCE_AttackStarted",
		}),
		PlaceObj('QuestVarTCEState', {
			Name = "TCE_ErnieLost",
		}),
		PlaceObj('QuestVarTCEState', {
			Name = "TCE_SquadDead",
		}),
		PlaceObj('QuestVarBool', {
			Name = "Completed",
		}),
		PlaceObj('QuestVarBool', {
			Name = "Given",
		}),
		PlaceObj('QuestVarBool', {
			Name = "Failed",
		}),
		PlaceObj('QuestVarBool', {
			Name = "NotStarted",
			Value = true,
		}),
	},
	group = "Ernie",
	id = "Ernie_CounterAttack",
})

