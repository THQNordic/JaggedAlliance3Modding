-- ========== GENERATED BY QuestsDef Editor (Ctrl-Alt-Q) DO NOT EDIT MANUALLY! ==========

PlaceObj('QuestsDef', {
	Author = "Boyan",
	Chapter = "Intro",
	DevNotes = "",
	DisplayName = T(448636111761, --[[QuestsDef LegionFlag DisplayName]] "Fooling Pierre"),
	EffectOnChangeVarValue = {
		PlaceObj('QuestEffectOnStatus', {
			Effects = {
				PlaceObj('QuestSetVariableTimer', {
					Prop = "FlagTimer",
					QuestId = "LegionFlag",
					TimeAmount = 2,
				}),
			},
			Prop = "Given",
		}),
		PlaceObj('QuestEffectOnStatus', {
			Effects = {
				PlaceObj('ConditionalEffect', {
					'Conditions', {
						PlaceObj('EnemySquadInSector', {
							sector_id = "H4",
						}),
						PlaceObj('PlayerIsInSectors', {
							Sectors = {
								"H4",
							},
						}),
					},
					'Effects', {
						PlaceObj('SectorEnterConflict', {
							sector_id = "H4",
						}),
					},
				}),
			},
			Prop = "Failed",
		}),
		PlaceObj('QuestEffectOnStatus', {
			Effects = {
				PlaceObj('GrantExperienceSector', {
					logImportant = true,
				}),
				PlaceObj('CityGrantLoyalty', {
					Amount = -5,
					City = "ErnieVillage",
					SpecialConversationMessage = T(920447698421, --[[QuestsDef LegionFlag SpecialConversationMessage]] "raised a <em>Legion flag</em>"),
				}),
				PlaceObj('PlayBanterEffect', {
					Banters = {
						"CorazonRadio_LegionFlag",
					},
					FallbackToMerc = true,
					banterSequentialWaitFor = "BanterStart",
					searchInMarker = false,
				}),
			},
			Prop = "FlagChanged",
		}),
	},
	Hidden = true,
	KillTCEsConditions = {
		PlaceObj('QuestIsVariableBool', {
			Condition = "or",
			QuestId = "LegionFlag",
			Vars = set( "Completed", "Failed" ),
			__eval = function ()
				local quest = gv_Quests['LegionFlag'] or QuestGetState('LegionFlag')
				return quest.Completed or quest.Failed
			end,
		}),
	},
	NoteDefs = {
		LastNoteIdx = 3,
	},
	QuestGroup = "Ernie Island",
	TCEs = {
		PlaceObj('TriggeredConditionalEvent', {
			Conditions = {
				PlaceObj('QuestIsVariableBool', {
					QuestId = "LegionFlag",
					Vars = set({
	Completed = false,
	Failed = false,
	Given = true,
}),
					__eval = function ()
						local quest = gv_Quests['LegionFlag'] or QuestGetState('LegionFlag')
						return not quest.Completed and not quest.Failed and quest.Given
					end,
				}),
				PlaceObj('QuestIsVariableBool', {
					QuestId = "PierreDefeated",
					Vars = {
						PierreInactive = true,
					},
					__eval = function ()
						local quest = gv_Quests['PierreDefeated'] or QuestGetState('PierreDefeated')
						return quest.PierreInactive
					end,
				}),
			},
			Effects = {
				PlaceObj('QuestSetVariableBool', {
					Prop = "Failed",
					QuestId = "LegionFlag",
				}),
			},
			Once = true,
			ParamId = "QuestSelfKill",
			QuestId = "LegionFlag",
		}),
	},
	Variables = {
		PlaceObj('QuestVarBool', {
			Name = "FlagChanged",
		}),
		PlaceObj('QuestVarTCEState', {
			Name = "QuestSelfKill",
		}),
		PlaceObj('QuestVarBool', {
			Name = "Completed",
		}),
		PlaceObj('QuestVarBool', {
			Name = "Given",
		}),
		PlaceObj('QuestVarNum', {
			Name = "FlagTimer",
		}),
		PlaceObj('QuestVarBool', {
			Name = "Failed",
		}),
		PlaceObj('QuestVarBool', {
			Name = "NotStarted",
			Value = true,
		}),
	},
	group = "Ernie",
	id = "LegionFlag",
})

