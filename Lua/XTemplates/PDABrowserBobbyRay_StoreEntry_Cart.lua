-- ========== GENERATED BY XTemplate Editor (Alt-F3) DO NOT EDIT MANUALLY! ==========

PlaceObj('XTemplate', {
	__is_kind_of = "XContextWindow",
	group = "BobbyRayGunsShop",
	id = "PDABrowserBobbyRay_StoreEntry_Cart",
	PlaceObj('XTemplateWindow', {
		'__class', "XContextWindow",
		'IdNode', true,
		'MouseCursor', "UI/Cursors/Pda_Cursor.tga",
		'ContextUpdateOnOpen', true,
		'OnContextUpdate', function (self, context, ...)
			self:Rebuild()
		end,
	}, {
		PlaceObj('XTemplateFunc', {
			'name', "Rebuild(self)",
			'func', function (self)
				local item = self.parent:GetContext()
				local stock = BobbyRayStoreGetEntry(item) and BobbyRayStoreGetEntry(item).Stock or 0
				local cart_number = (BobbyRayCartGetUnits()[item.id] or 0)
				stock = stock - cart_number
				local cost = BobbyRayStoreGetEntry(item) and BobbyRayStoreGetEntry(item).Cost or 0
				local stack = item.ShopStackSize or 1
				
				-- money
				local cost_value = self:ResolveId("idCost"):ResolveId("idValue")
				cost_value:SetText(T{770368132801, "<money(Cost)>", Cost = cost})
				if BobbyRayCartHasEnoughMoney(item) then
					cost_value:SetTextStyle("PDABobbyStore_HG16F")
				else
					cost_value:SetTextStyle("PDABobbyStore_HG16I")
				end
				
				
				self:ResolveId("idCart"):SetVisible(cart_number ~= 0)
				self:ResolveId("idCart"):ResolveId("idValue"):SetText(stack ~= 1 and T{835688467903, "<quant>x<stack>", quant = cart_number, stack = stack } or Untranslated(cart_number))
				
				-- stock
				local stock_value = self:ResolveId("idStock"):ResolveId("idValue")
				local stock_value_single = self:ResolveId("idStock"):ResolveId("idSingle")
				local stock_text = self:ResolveId("idStock"):ResolveId("idStatName")
				
				stock_value:SetVisible(stock > 1)
				stock_value:SetText(stack ~= 1 and T{835688467903, "<quant>x<stack>", quant = stock, stack = stack } or Untranslated(stock))
				stock_text:SetVisible(stock ~= 1)
				stock_text:SetText(stock == 0 and T(805046923953, "Out of stock") or T(918709667321, "In stock"))
				stock_text:SetTextStyle(stock == 0 and "PDABobbyStore_HG16K" or "PDABobbyStore_HG16D")
				stock_value_single:SetVisible(stock == 1)
			end,
		}),
		PlaceObj('XTemplateWindow', {
			'comment', "observer for BobbyRayCartChanges",
			'__context', function (parent, context) return g_BobbyRayCart end,
			'__class', "XContextControl",
			'Visible', false,
			'FoldWhenHidden', true,
			'OnContextUpdate', function (self, context, ...)
				self.parent:Rebuild()
			end,
		}),
		PlaceObj('XTemplateWindow', {
			'Padding', box(5, 5, 5, 5),
			'Dock', "top",
			'LayoutMethod', "VList",
		}, {
			PlaceObj('XTemplateWindow', {
				'Id', "idCost",
				'IdNode', true,
				'GridStretchX', false,
				'GridStretchY', false,
			}, {
				PlaceObj('XTemplateWindow', {
					'__class', "XText",
					'Id', "idStatName",
					'Padding', box(0, 0, 0, 0),
					'Dock', "left",
					'TextStyle', "PDABobbyStore_HG16D",
					'Translate', true,
					'Text', T(879462448033, --[[XTemplate PDABrowserBobbyRay_StoreEntry_Cart Text]] "COST"),
				}),
				PlaceObj('XTemplateWindow', {
					'__class', "XText",
					'Id', "idValue",
					'Padding', box(0, 0, 0, 0),
					'Dock', "right",
					'TextStyle', "PDABobbyStore_HG16F",
					'Translate', true,
				}),
				}),
			PlaceObj('XTemplateWindow', {
				'Id', "idStock",
				'IdNode', true,
				'GridStretchX', false,
				'GridStretchY', false,
			}, {
				PlaceObj('XTemplateWindow', {
					'__class', "XText",
					'Id', "idStatName",
					'Padding', box(0, 0, 0, 0),
					'Dock', "left",
					'FoldWhenHidden', true,
					'TextStyle', "PDABobbyStore_HG16D",
					'Translate', true,
				}),
				PlaceObj('XTemplateWindow', {
					'__class', "XText",
					'Id', "idValue",
					'Padding', box(0, 0, 0, 0),
					'Dock', "right",
					'FoldWhenHidden', true,
					'TextStyle', "PDABobbyStore_HG16F",
					'Translate', true,
				}),
				PlaceObj('XTemplateWindow', {
					'__class', "XText",
					'Id', "idSingle",
					'Padding', box(0, 0, 0, 0),
					'Dock', "left",
					'FoldWhenHidden', true,
					'TextStyle', "PDABobbyStore_HG16K",
					'Translate', true,
					'Text', T(537709509337, --[[XTemplate PDABrowserBobbyRay_StoreEntry_Cart Text]] "LAST AVAILABLE!"),
				}),
				}),
			}),
		PlaceObj('XTemplateWindow', {
			'Id', "idCart",
			'IdNode', true,
			'Padding', box(5, 5, 5, 5),
			'Dock', "box",
			'Background', RGBA(88, 92, 68, 157),
		}, {
			PlaceObj('XTemplateWindow', {
				'__class', "XImage",
				'Id', "idStatName",
				'Margins', box(10, 0, 0, 0),
				'Dock', "left",
				'VAlign', "center",
				'Image', "UI/PDA/WEBSites/Bobby Rays/shop_cart.png",
			}),
			PlaceObj('XTemplateWindow', {
				'__class', "XText",
				'Id', "idValue",
				'Padding', box(0, 0, 0, 0),
				'Dock', "right",
				'VAlign', "center",
				'TextStyle', "PDABobbyStore_HG16K",
				'Translate', true,
			}),
			}),
		}),
})

